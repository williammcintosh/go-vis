<!DOCTYPE html>
<html>
  <head>
    <title>Go Memory Trainer</title>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <link rel="stylesheet" href="style.css" />
  </head>
  <body data-page="home">
    <header class="site-header">
      <div class="site-header__content site-header__content--brand">
        <div class="site-header__section site-header__section--left">
          <div
            class="brand"
            id="aboutTrigger"
            role="button"
            tabindex="0"
            aria-label="Open About"
            style="cursor: pointer"
          >
            <img
              src="./images/go-icon.png"
              alt="Go Viz logo"
              class="brand-logo"
            />
            <span class="brand-name">Read Go Fast</span>
          </div>
        </div>
        <div class="site-header__section site-header__section--right">
          <div id="account-area" class="account-area" aria-live="polite"></div>
        </div>
      </div>
      <div class="site-header__content site-header__content--badges">
      <div class="site-header__section site-header__section--left">
        <div id="goldBadge" class="gold-badge badge" aria-live="polite">
          <div class="gold-badge__frame">
            <div class="gold-badge__core">
              <span id="goldValue" class="gold-badge__value">0</span>
              <span class="gold-badge__label">Gold</span>
            </div>
          </div>
        </div>
      </div>
      <div class="site-header__section site-header__section--center">
        <button
          id="gameAvatar"
          class="game-avatar-btn"
          type="button"
          aria-label="Account"
          aria-haspopup="true"
          aria-expanded="false"
        >
          <img
            id="gameAvatarImg"
            class="game-avatar-img"
            src="./images/not-logged-in-avatar.png"
            alt="Account avatar"
            width="40"
            height="40"
          />
        </button>
      </div>
      <div class="site-header__section site-header__section--right">
        <div id="skillBadge" class="skill-badge badge" aria-live="polite">
          <div class="skill-badge__frame">
            <div class="skill-badge__core">
              <span id="skillRatingText" class="skill-badge__value">--</span>
                <span class="skill-badge__label">Skill</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>
    <div id="intro" class="screen active">
      <div class="hero">
        <p class="hero-tagline">Train your Go memory and visualization.</p>
        <button id="start-btn" class="primary-action">Play</button>
      </div>
    </div>

    <div id="aboutModal" class="modal" aria-hidden="true">
      <div
        class="modal-content"
        role="dialog"
        aria-modal="true"
        aria-labelledby="aboutModalTitle"
        style="
          max-width: 780px;
          width: min(92vw, 780px);
          text-align: center;
          padding: 24px;
        "
      >
        <h1 id="aboutModalTitle" style="margin: 0">About</h1>
        <p style="opacity: 0.9; margin: 0 auto; max-width: 720px">
          Read Go Fast is a Go memory and visualization trainer focused on fast
          pattern recognition and reading at a glance.
        </p>

        <section style="margin: 0">
          <h2 style="margin: 0">App version</h2>
          <p style="margin: 0">Version: <span>v1.0.0</span></p>
        </section>

        <section style="margin: 0">
          <h2 style="margin: 0">Contact</h2>
          <p style="margin: 0">
            <a href="mailto:will@wmm.co.nz">will@wmm.co.nz</a>
          </p>
        </section>

        <section style="margin: 0">
          <h2 style="margin: 0">Legal</h2>
          <p style="margin: 0">
            <a href="privacy.html">Privacy Policy</a> ·
            <a href="terms.html">Terms of Service</a>
          </p>
        </section>

        <p style="margin: 0">
          <a href="index.html">Back to Home</a>
        </p>
        <button id="aboutClose" style="padding: 10px 18px; min-width: 140px">
          Close
        </button>
      </div>
    </div>

    <!-- Restart Confirmation Modal -->
    <div id="confirmModal" class="modal">
      <div class="modal-content">
        <p style="margin-bottom: 10px">
          This will erase all progress on this device and in the cloud for your account.
        </p>
        <p style="margin-top: 0; font-size: 0.95rem; opacity: 0.85">
          If you just want to switch accounts, log out instead.
        </p>
        <div class="modal-buttons">
          <button id="confirmNo">Cancel</button>
          <button id="confirmYes">Yes, restart</button>
          <button id="confirmLogout">Log out instead</button>
        </div>
      </div>
    </div>

    <div id="difficulty">
      <div class="top">
        <img src="images/go-icon.png" alt="Go Viz icon" class="logo" />
        <h1>Go Viz</h1>
      </div>
      <div class="btn-col">
        <div class="mode-grid">
          <div class="mode-card mode-card--horizontal" id="position-card">
            <div class="mode-icon">
              <img src="images/position.png" alt="Position mode" />
            </div>
            <div class="mode-content">
              <button class="diffBtn" data-mode="position">Position</button>
              <p class="mode-status" id="mode-status-position">Beginner</p>
            </div>
          </div>
          <div class="mode-card mode-card--horizontal" id="sequence-card">
            <div class="mode-icon">
              <img src="images/sequence.png" alt="Sequence mode" />
            </div>
            <div class="mode-content">
              <button class="diffBtn" data-mode="sequence">Sequence</button>
              <p class="mode-status" id="mode-status-sequence">Advanced</p>
            </div>
          </div>
        </div>
        <button id="homeBtn">Home</button>
      </div>
    </div>

    <div id="mainGame">
      <div class="game-wrapper">
        <div class="board-shell">
          <div id="board"></div>
        </div>
        <div id="modeProgressRow" aria-label="mode and progress"></div>
        <div id="timerContainer" class="is-timing" aria-live="polite">
          <div
            id="timerBar"
            role="progressbar"
            aria-label="Time remaining"
          ></div>
          <button id="checkBtn" type="button">Check</button>
        </div>
        <div id="bonusContainer">
          <button type="button" class="bonus bonus-button" id="addTimeBonus">
            <span class="bonus-icon" aria-hidden="true">
              <img src="images/addTime.png" alt="" />
            </span>
            <span class="bonus-label">Add Time</span>
            <span class="bonus-cost">
              <img src="images/gold.png" alt="" class="bonus-cost-icon" />
              <span class="bonus-cost-value">-500</span>
            </span>
          </button>
          <button type="button" class="bonus bonus-button" id="eyeGlassBonus">
            <span class="bonus-icon" aria-hidden="true">
              <img src="images/eyeGlass.png" alt="" />
            </span>
            <span class="bonus-label">Peek Stones</span>
            <span class="bonus-cost">
              <img src="images/gold.png" alt="" class="bonus-cost-icon" />
              <span class="bonus-cost-value">-500</span>
            </span>
          </button>
        </div>
        <div id="feedback">
          <p id="feedbackMsg"></p>
          <div id="goldPopup"></div>
          <div class="feedback-bottom-row">
            <button id="nextBtn">Next</button>
            <button id="homeBtn2">Home</button>
          </div>
        </div>
      </div>
    </div>

    <div id="settingsModal" class="screen">
      <div class="settings-content">
        <h2>Settings</h2>
        <div class="setting-group">
          <h3>Tap Mode</h3>
          <label class="tap-mode-option">
            <input type="radio" name="tapMode" value="classic" checked />
            <div class="option-copy">
              <span class="option-title">Classic</span>
              <span class="option-desc"
                >Tap cycles black → white → empty, matching the original
                behavior.</span
              >
            </div>
          </label>
          <label class="tap-mode-option">
            <input type="radio" name="tapMode" value="toggle" />
            <div class="option-copy">
              <span class="option-title">Toggle stones</span>
              <span class="option-desc"
                >Tap flips stone color, double-tap removes, and empty taps add
                the opposite color of your last stone.</span
              >
            </div>
          </label>
        </div>

        <div class="settings-about">
          <h3>About Go Viz</h3>
          <p>
            During the timer, examine the stones and remember their color and
            location. When the timer ends, repeat the same pattern and tap Check
            to see how you did.
          </p>
          <p>
            Double-tap anywhere on the screen during memorization to speed up
            the timer. Progress through all the levels, improve your memory, and
            have fun!
          </p>
        </div>
        <div class="settings-actions">
          <button id="settingsHomeBtn" class="green-btn">Home</button>
        </div>
      </div>
    </div>

    <!-- Tutorial overlay elements -->
    <div id="tutorialOverlay" class="tutorial-overlay tutorial-hidden"></div>
    <div
      id="tutorialHighlight"
      class="tutorial-highlight tutorial-hidden"
    ></div>
    <div id="tutorialTooltip" class="tutorial-tooltip tutorial-hidden">
      <p id="tutorialText"></p>
      <button id="tutorialOkBtn">Okay</button>
    </div>
    <div id="tutorialSkip" class="tutorial-skip tutorial-hidden">
      <button id="tutorialSkipBtn">Skip tutorial</button>
    </div>

    <script>
      (() => {
        const trigger = document.getElementById('aboutTrigger');
        const modal = document.getElementById('aboutModal');
        const closeBtn = document.getElementById('aboutClose');

        if (!trigger || !modal) return;

        const open = () => {
          modal.classList.add('active');
          modal.setAttribute('aria-hidden', 'false');
        };

        const close = () => {
          modal.classList.remove('active');
          modal.setAttribute('aria-hidden', 'true');
          trigger.focus();
        };

        trigger.addEventListener('click', open);
        trigger.addEventListener('keydown', (event) => {
          if (event.key === 'Enter' || event.key === ' ') {
            event.preventDefault();
            open();
          }
        });

        closeBtn?.addEventListener('click', close);
        modal.addEventListener('click', (event) => {
          if (event.target === modal) {
            close();
          }
        });
      })();
    </script>

    <script type="module" src="./firebase-init.js"></script>
    <script src="board-logic.js"></script>
    <script type="module" src="app.js"></script>
    <script src="auth-ui.js"></script>
  </body>
</html>
